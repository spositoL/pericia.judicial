<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IHC & UX - Portal da Disciplina | Dr. Lincoln Sposito</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5F1FGJ25TK"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-5F1FGJ25TK');

      function logAcesso(status, ref, aula) {
		gtag('event', 'presenca_aula', {
			'disciplina': 'Sistemas_Distribuidos', // Alterado de IHC_UX
			'status_presenca': status,
			'origem': ref,
			'aula_referencia': aula 
		});
	  }
    </script>

    <style>
        :root { --navy: #002147; --white: #ffffff; --accent: #28a745; --warning: #ffc107; --card-bg: #003366; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background-color: var(--navy); color: var(--white); margin: 0; text-align: center; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        #portal-entrada { background: white; padding: 30px; border-radius: 20px; display: none; margin: 20px auto; color: var(--navy); max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #qrcode { display: flex; justify-content: center; margin: 20px 0; }
        #aula-em-curso { display: none; background: var(--card-bg); padding: 20px; border-radius: 15px; border: 2px dashed var(--warning); margin: 20px 0; }
        .tabela-aulas { width: 100%; border-collapse: collapse; margin-top: 30px; background: var(--card-bg); border-radius: 10px; overflow: hidden; }
        .tabela-aulas th, .tabela-aulas td { padding: 18px; border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left; }
        .tabela-aulas th { background: rgba(0,0,0,0.3); color: var(--accent); }
        .btn-link { color: var(--white); text-decoration: none; font-weight: bold; border: 1px solid var(--accent); padding: 8px 15px; border-radius: 5px; display: inline-block; }
        .atrasado-lock { opacity: 0.5; cursor: not-allowed; }
		
		.btn-voltar {
			margin-left: auto; /* Empurra o bot√£o para a direita */
			color: var(--white);
			text-decoration: none;
			font-size: 1rem;
			font-weight: bold;
			padding: 8px 15px;
			border: 1px solid rgba(255,255,255,0.3);
			border-radius: 8px;
			transition: 0.3s;
			background: rgba(255,255,255,0.05);
		}

		.btn-voltar:hover {
			background: var(--accent);
			border-color: var(--accent);
			transform: translateX(-5px); /* Efeito visual de retorno */
		}

		/* Esconder o texto no mobile para n√£o apertar o header, deixando apenas a seta se preferir */
		@media (max-width: 480px) {
			.btn-voltar {
				font-size: 0.8rem;
				padding: 5px 10px;
			}
		}
		
		.btn-perito {
			display: inline-block;
			background-color: var(--accent);
			color: var(--white);
			text-decoration: none;
			padding: 15px 30px;
			border-radius: 8px;
			font-weight: bold;
			font-size: 1.1rem;
			transition: all 0.3s ease;
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.btn-perito:hover {
			background-color: #218838; /* Um tom de verde mais escuro */
			transform: translateY(-3px);
			box-shadow: 0 5px 15px rgba(0,0,0,0.3);
		}

		@media (max-width: 480px) {
			.btn-perito {
				width: 100%;
				font-size: 1rem;
			}
		}
		
    </style>
</head>
<body>

<div class="container">
    <header>
		<div style="font-size: 50px; margin-top: 20px;"><img src="../img/grafico.svg" alt="Logo" style="height: 60px; margin-top: 20px;">üåê</div>
		<h1>Sistemas Distribu√≠dos</h1>
		<p>Portal da Disciplina | Prof. Dr. Lincoln Sposito</p>
		<a href="../index.html" class="btn-voltar" onclick="logInteracao('navegacao', 'retorno_portal', 'header')">‚Üê Voltar ao Portal de Disciplinas</a>
		<a href="../../index.html" class="btn-voltar">Conhe√ßa meu trabalho como perito</a><br>
	</header>

    <div id="portal-entrada">
        <h2 style="margin-top:0">RITUAL DE ENTRADA</h2>
        <div id="qrcode"></div> 
        <p><strong>Aponte para confirmar presen√ßa pontual.</strong></p>
    </div>

    <div id="aula-em-curso">
        <h3>‚ö†Ô∏è Aula em Curso</h3>
        <p>O acesso ao material est√° a ser projetado pelo professor. Se chegou agora, utilize o QR Code no slide projetado para registrar o seu atraso.</p>
    </div>

    <table class="tabela-aulas" id="tabelaAulas">
        <thead>
            <tr>
                <th>Data</th>
				<th>Hora In√≠cio</th>
                <th>Conte√∫do</th>
                <th>Acesso</th>
            </tr>
        </thead>
        <tbody>
			<tr data-date="2026-02-09" data-start="19:00" data-url="aula-09-02-2026.html">
				<td>09/02/2026</td>
				<td>19:00</td>
				<td>Introdu√ß√£o aos Sistemas Distribu√≠dos e Protocolo HTTP</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-02-23" data-start="19:00" data-url="aula-23-02-2026.html">
				<td>23/02/2026</td>
				<td>19:00</td>
				<td>JSON/XML e Servi√ßos de Integra√ß√£o Web</td>
				<td class="col-link"></td>
			</tr>

			<tr data-date="2026-03-02" data-start="19:00" data-url="aula-02-03-2026.html">
				<td>02/03/2026</td>
				<td>19:00</td>
				<td>Componentiza√ß√£o e Padr√µes de Projeto Modernos</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-03-09" data-start="19:00" data-url="aula-09-03-2026.html">
				<td>09/03/2026</td>
				<td>19:00</td>
				<td>SOA (Arquitetura Orientada a Servi√ßos) e SOAP/REST</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-03-16" data-start="19:00" data-url="aula-16-03-2026.html">
				<td>16/03/2026</td>
				<td>19:00</td>
				<td>Microsservi√ßos e API Gateways</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-03-23" data-start="19:00" data-url="aula-23-03-2026.html">
				<td>23/03/2026</td>
				<td>19:00</td>
				<td><b>Avalia√ß√£o A1:</b> Pr√°tica de Constru√ß√£o de API</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-03-30" data-start="19:00" data-url="aula-30-03-2026.html">
				<td>30/03/2026</td>
				<td>19:00</td>
				<td>Mensageria e Comunica√ß√£o Ass√≠ncrona (RabbitMQ/Kafka)</td>
				<td class="col-link"></td>
			</tr>

			<tr data-date="2026-04-06" data-start="19:00" data-url="aula-06-04-2026.html">
				<td>06/04/2026</td>
				<td>19:00</td>
				<td>Cloud Computing: IaaS, PaaS, SaaS e Serverless</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-04-13" data-start="19:00" data-url="aula-13-04-2026.html">
				<td>13/04/2026</td>
				<td>19:00</td>
				<td>Edge Computing (Computa√ß√£o de Borda)</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-04-27" data-start="19:00" data-url="aula-27-04-2026.html">
				<td>27/04/2026</td>
				<td>19:00</td>
				<td>Teorema CAP e Bancos de Dados Distribu√≠dos</td>
				<td class="col-link"></td>
			</tr>

			<tr data-date="2026-05-04" data-start="19:00" data-url="aula-04-05-2026.html">
				<td>04/05/2026</td>
				<td>19:00</td>
				<td>NoSQL e Escalabilidade Horizontal</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-05-11" data-start="19:00" data-url="aula-11-05-2026.html">
				<td>11/05/2026</td>
				<td>19:00</td>
				<td><b>Avalia√ß√£o A2:</b> Simula√ß√£o Cloud</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-05-18" data-start="19:00" data-url="aula-18-05-2026.html">
				<td>18/05/2026</td>
				<td>19:00</td>
				<td>Programa√ß√£o Paralela: Threads e Sincroniza√ß√£o</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-05-25" data-start="19:00" data-url="aula-25-05-2026.html">
				<td>25/05/2026</td>
				<td>19:00</td>
				<td>Seguran√ßa (OAuth2/JWT) e Confiabilidade</td>
				<td class="col-link"></td>
			</tr>

			<tr data-date="2026-06-01" data-start="19:00" data-url="aula-01-06-2026.html">
				<td>01/06/2026</td>
				<td>19:00</td>
				<td>Internet das Coisas (IoT) e Protocolo MQTT</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-06-15" data-start="19:00" data-url="aula-15-06-2026.html">
				<td>15/06/2026</td>
				<td>19:00</td>
				<td><b>Avalia√ß√£o A3:</b> Deploy Ponta-a-Ponta</td>
				<td class="col-link"></td>
			</tr>
			<tr data-date="2026-03-01" data-start="17:58" data-url="aula-15-06-2026.html">
				<td>01/03/2026</td>
				<td>21:23</td>
				<td><b>AULA TESTE</td>
				<td class="col-link"></td>
			</tr>
		</tbody>
    </table>
</div>

<section style="margin: 40px auto; max-width: 900px; padding: 0 20px; text-align: center;">
    <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1); margin-bottom: 40px;">
    
    <div class="card-perito" style="background: rgba(255,255,255,0.05); border: 1px solid var(--accent); border-radius: 15px; padding: 30px;">
        <h2 style="color: var(--warning); margin-top: 0;">Al√©m da Sala de Aula</h2>
        <p style="margin-bottom: 25px;">Conhe√ßa minha atua√ß√£o profissional em per√≠cias judiciais e consultoria especializada.</p>
        
        <a href="../../index.html" class="btn-perito">
            Conhe√ßa meu trabalho como perito
        </a>
    </div>
</section>

<script>
    function gerirFluxo() {
        // 1. Pega a data e hora local (conforme seu script anterior de sucesso)
        const agora = new Date();
        const offset = agora.getTimezoneOffset();
        const hojeLocal = new Date(agora.getTime() - (offset*60*1000)).toISOString().split('T')[0];
        
        const horaAtual = agora.getHours();
        const minAtual = agora.getMinutes();
        const tempoAtualMin = (horaAtual * 60) + minAtual;

        const rows = document.querySelectorAll('#tabelaAulas tbody tr');

        rows.forEach(row => {
            const dataAula = row.getAttribute('data-date');
            const horaInicioRaw = row.getAttribute('data-start');
            const urlAula = row.getAttribute('data-url');
            const linkCell = row.querySelector('.col-link');

            if (dataAula === hojeLocal && horaInicioRaw) {
                const [h, m] = horaInicioRaw.split(':').map(Number);
                const tempoInicioMin = (h * 60) + m;
                const limitePontual = tempoInicioMin + 17;

                // Janela de Presen√ßa Pontual (Item 2 e 3 do seu roteiro)
                if (tempoAtualMin >= tempoInicioMin && tempoAtualMin <= limitePontual) {
                    const urlFinal = window.location.origin + window.location.pathname.replace('index.html', '') + urlAula + "?ref=index";
                    
                    document.getElementById('portal-entrada').style.display = 'block';
                    
                    // Gera o QR Code usando a biblioteca QRCode.js
                    document.getElementById("qrcode").innerHTML = "";
                    new QRCode(document.getElementById("qrcode"), {
                        text: urlFinal,
                        width: 200, height: 200,
                        colorDark : "#002147", colorLight : "#ffffff"
                    });

                    if(linkCell) linkCell.innerHTML = `<a href="${urlAula}?ref=index" class="btn-link" onclick="logAcesso('pontual', 'index')">Entrar na Aula</a>`;
                } 
                // Janela de Atraso (Item 4 e 6)
                else if (tempoAtualMin > limitePontual && tempoAtualMin <= (tempoInicioMin + 180)) {
                    document.getElementById('aula-em-curso').style.display = 'block';
                    if(linkCell) linkCell.innerHTML = `<span class="atrasado-lock">Acesso via Proje√ß√£o</span>`;
                }
            } else if (linkCell) {
                linkCell.innerHTML = `<a href="${urlAula}?ref=estudo" class="btn-link" onclick="logAcesso('engajamento', 'extra-classe')">Revisar Material</a>`;
            }
        });
    }

    window.onload = function() {
        setTimeout(gerirFluxo, 500);
    };
</script>
</body>
</html>